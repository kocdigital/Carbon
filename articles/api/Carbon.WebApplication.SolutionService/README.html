<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Carbon.WebApplication.SolutionService | Carbon Framework </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Carbon.WebApplication.SolutionService | Carbon Framework ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../../images/logo.png">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="carbonwebapplicationsolutionservice">Carbon.WebApplication.SolutionService</h1>

<blockquote>
<p>!This package is KocDigital specific package. May not work for open-source purposes!</p>
</blockquote>
<p>This package gives you the mighty power of registering your own solutions, featuresets and all the permission with its granular pieces as code-first to Platform360.</p>
<p>For the sake of better understanding of solution structure in Platform360, refer to this <a href="https://www.fruct.org/publications/volume-32/fruct32/files/Ayt.pdf">Scientific Article</a></p>
<h2 id="add-solutionservice-support-to-your-project">Add SolutionService Support to Your Project</h2>
<p>This package uses Carbon.MassTransit behind the scenes.</p>
<p><strong>1. Register your service as a solution registerable service</strong></p>
<pre><code class="lang-csharp">//IServiceCollection services;
services.ConfigureAsSolutionService(Configuration);
</code></pre>
<p><strong>2. Add your Masstransit Configuration</strong></p>
<p>This package uses a saga orchestration to register your solution to the system safely. This is provided by a Message Queueing infrastructure (such as RabbitMQ)</p>
<pre><code class="lang-json">&quot;MassTransit&quot;: {
    &quot;BusType&quot;: 1,
    &quot;RabbitMq&quot;: {
      &quot;Host&quot;: &quot;rabbitmqhost&quot;,
      &quot;Username&quot;: &quot;rabbitmquser&quot;,
      &quot;Password&quot;: &quot;rabbitmqpassword&quot;,
      &quot;VirtualHost&quot;: &quot;/yourvirtualhost&quot;,
      &quot;Port&quot;: 5672
    },
    &quot;ServiceBus&quot;: {
      &quot;ConnectionString&quot;: &quot;&quot;
    }
  },
</code></pre>
<p><strong>3. Create your solution as code-first</strong></p>
<p>//Define a solution with name and static guid</p>
<pre><code class="lang-csharp">public static Solution GetSolutionMigration()
        {
            return new Solution()
            {
                SolutionId = new Guid(&quot;00112233-C637-42ED-F4BE-08D7F1B05268&quot;),
                SolutionName = &quot;Solution1&quot;,
                Description = &quot;Solution1 Description&quot;,
                Icon = @&quot;data:image/png;base64,yourimage's base64 encoded string&quot;
                Version = 2
            };
        }
</code></pre>
<p>Every time you increase the version will be detected as a modification by the system, so the solution will be re-registered. Otherwise
there will be no action.</p>
<p><strong>3. Create your featureset as code-first</strong></p>
<p>Define a featureset with all the permissions. In this example FeatureSet properties are empty. But you should fill them accordingly.
For further detail for filling them, refer to incoming section.</p>
<pre><code class="lang-csharp">public static List&lt;FeatureSet&gt; GetFeatureSetMigration()
        {
            List&lt;FeatureSet&gt; featureSets = new List&lt;FeatureSet&gt;();

            featureSets.Add(
            new FeatureSet()
            {
                FeatureSetId = new Guid(&quot;99887766-F8D1-4916-BA04-469CCF50C1C3&quot;),
                FeatureSetName = &quot;FeatureSet1&quot;,
                Description = &quot;FeatureSet1&quot;,
                EndpointItemPermissions = new List&lt;EndpointItemPermission&gt;(),

                MenuItemPermissions = new List&lt;MenuItemPermission&gt;(),

                UIItemPermissions = new List&lt;UIItemPermission&gt;(),

                PermissionGroups = new List&lt;PermissionGroup&gt;(),

                PermissionGroupEndpointItemPermissionRelations = new List&lt;PermissionGroupEndpointItemPermissionRelation&gt;(),

                PermissionGroupMenuItemPermissionRelations = new List&lt;PermissionGroupMenuItemPermissionRelation&gt;(),

                PermissionGroupUIItemPermissionRelations = new List&lt;PermissionGroupUIItemPermissionRelation&gt;(),

                Features = new List&lt;Feature&gt;(),

                Version = 18
            });

            return featureSets;
        }
</code></pre>
<p>Likewise the solution version, if you increase the version, the environment that is below this version will start a migration and order your permissions as you desire, otherwise it will ignore or show up an error.</p>
<p><strong>4. Register your solutions and featuresets you prepared</strong></p>
<pre><code class="lang-csharp">//IApplicationBuilder app
var solution = SolutionMigration.GetSolutionMigration();
var featuresets = SolutionMigration.GetFeatureSetMigration();

//First register your solution
app.RegisterAsSolution(new SolutionCreationRequest() { Solution = solution });

//And then register your featureset that is tied to your solution
foreach (var featureset in featuresets)
{
    app.RegisterAsFeatureSet(new FeatureSetCreationRequest() { FeatureSet = featureset, SolutionId = solution.SolutionId });
}
</code></pre>
<p>Once you run the code bunch above, the output in the console will likely be as given below
(let's assume you have 1 solution with 2 featuresets)</p>
<pre><code class="lang-output">Solution has successfully submitted- SolutionId: {SolutionId}, SolutionName: {SolutionName}
FeatureSet Registration has successfully submitted for given Solution {SolutionId} FeatureSet: {FeatureSetName}
FeatureSet Registration has successfully submitted for given Solution {SolutionId} FeatureSet: {FeatureSetName}
</code></pre>
<p>In case of completing with a happy ending the output in the console will likely be as given below (Successful migration or ignored due to same version) :</p>
<pre><code class="lang-output">Solution has successfully registered- SolutionId: {SolutionId}, SolutionName: {SolutionName}
FeatureSet has successfully registered to SolutionId: {SolutionId}, FeatureSet: {FeatureSetId}
FeatureSet has successfully registered to SolutionId: {SolutionId}, FeatureSet: {FeatureSetId}
</code></pre>
<p>In case of completing with an error the output in the console will likely be as given below (Successful migration failed due to misconfiguration of your featuresets or version conflicts such as greater version in the environment than you defined in your code) :</p>
<pre><code class="lang-output">Solution registration has failed- SolutionId: {SolutionId}, SolutionName: {SolutionName}, Error: {ErrorMessage}
FeatureSet registration has failed to SolutionId: {SolutionId}, FeatureSet: {FeatureSetId}, Error: {ErrorMessage}
FeatureSet registration has failed to SolutionId: {SolutionId}, FeatureSet: {FeatureSetId}, Error: {ErrorMessage}
</code></pre>
<h2 id="more-details-for-featureset">More Details for FeatureSet</h2>
<p>Preparing a featureset with all permissions might be a cumbersome and may create a burden on you if you are not very familiar with it.
However, there are something to be handled by care. Please read each property's description to learn what is what.</p>
<ul>
<li><strong>EndpointItemPermission (Authorization of your endpoints in your API)</strong></li>
</ul>
<pre><code class="lang-csharp">//You can add EndpointItemPermission as much as you want
new EndpointItemPermission()
{
    //You should use your related solution's ID that is declared in previous section
    ApplicationId = new Guid(&quot;00112233-C637-42ED-F4BE-08D7F1B05268&quot;),
    //Same with your endpoint's authorization role name
    Code = &quot;VirtualTelemetry_ReadVirtualTelemetry&quot;,
    //Same with your endpoint's authorization role name
    Name = &quot;VirtualTelemetry_ReadVirtualTelemetry&quot;,
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;55669933-B625-4464-71F8-08D7F03A0AED&quot;)
},
</code></pre>
<ul>
<li><strong>MenuItemPermissions (Your menu items that appear in the UI)</strong></li>
</ul>
<pre><code class="lang-csharp">//You can add MenuItemPermission as much as you want
new MenuItemPermission() {
    //You should use your related solution's ID that is declared in previous section
    ApplicationId = new Guid(&quot;00112233-C637-42ED-F4BE-08D7F1B05268&quot;),
    //Appearence order in UI
    Order = 1,
    //Should be the same as defined in UI Project in menu.json
    Code = &quot;Asset List&quot;,
    //Should be the same as defined in UI Project in menu.json
    Name= &quot;Asset List&quot;,
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;6B06A500-D195-4053-BFEB-8029E4FB3B43&quot;),
    //Should be the same relative path as defined in UI Project in menu.json
    Uri = &quot;/AssetList&quot;,
    //Should be the same meta as defined in UI Project in menu.json
    Meta=&quot;{\&quot;path\&quot;:\&quot;/AssetList\&quot;,\&quot;title\&quot;:{\&quot;en\&quot;:\&quot;Asset Management\&quot;,\&quot;tr\&quot;:\&quot;Varlik Yönetimi\&quot;},\&quot;icon\&quot;:\&quot;mdi-domain\&quot;,\&quot;remote\&quot;:\&quot;$$p360micropage$$\&quot;,\&quot;name\&quot;:\&quot;project-assetlist-remote\&quot;}&quot;
},
</code></pre>
<ul>
<li><strong>UIItemPermissions (Your UI items that appear in the UI pages)</strong></li>
</ul>
<pre><code class="lang-csharp">//You can add UIItemPermission as much as you want
new UIItemPermission()
{
    //You should use your related solution's ID that is declared in previous section
    ApplicationId = new Guid(&quot;00112233-C637-42ED-F4BE-08D7F1B05268&quot;),
    //Should be the same as defined in UI Project
    Code = &quot;AssetUpdate&quot;,
    //Should be the same as defined in UI Project
    Name = &quot;AssetUpdate&quot;,
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;4AFB777B-56D7-4AB6-8D31-013E1EB6A66F&quot;)
},
</code></pre>
<ul>
<li><strong>PermissionGroups (The group that groups your all permissions in one place)</strong></li>
</ul>
<pre><code class="lang-csharp">new PermissionGroup()
{
    //You should use your related solution's ID that is declared in previous section
    ApplicationId = new Guid(&quot;00112233-C637-42ED-F4BE-08D7F1B05268&quot;),
    //Read=1, Create=2, Update=3, Delete =4
    Type = (PermissionGroupType)1,
    //Name of your Permission Group that is tells all the story about grouped permissions
    Name = &quot;Virtual Telemetry&quot;,
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;974F50BF-A30A-4299-513C-08D7F0C40890&quot;)
},
</code></pre>
<ul>
<li><strong>PermissionGroupEndpointItemPermissionRelations (The relationship between permission group and EndpointItemPermissions)</strong></li>
</ul>
<pre><code class="lang-csharp">new PermissionGroupEndpointItemPermissionRelation()
{
    // The permissiongroupid that you created above
    PermissionGroupId = new Guid(&quot;974F50BF-A30A-4299-513C-08D7F0C40890&quot;),
    //The endpoint item permissionid that you created above and you want to group in given permission gorup
    EndpointItemPermissionId = new Guid(&quot;55669933-B625-4464-71F8-08D7F03A0AED&quot;),
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;A371ECB2-A010-4797-7996-08D7F0DC4942&quot;)
},
</code></pre>
<ul>
<li><strong>PermissionGroupMenuItemPermissionRelations (The relationship between permission group and MenuItemPermissions)</strong></li>
</ul>
<pre><code class="lang-csharp">new PermissionGroupMenuItemPermissionRelation()
{
    // The permissiongroupid that you created above
    PermissionGroupId = new Guid(&quot;974F50BF-A30A-4299-513C-08D7F0C40890&quot;),
    //The menu item permissionid that you created above and you want to group in given permission gorup
    MenuItemPermissionId = new Guid(&quot;6B06A500-D195-4053-BFEB-8029E4FB3B43&quot;),
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;985123AA-4958-4958-4958-1234FCDC4982&quot;)
},
</code></pre>
<ul>
<li><strong>PermissionGroupUIItemPermissionRelations (The relationship between permission group and UIItemPermissions)</strong></li>
</ul>
<pre><code class="lang-csharp">new PermissionGroupMenuItemPermissionRelation()
{
    // The permissiongroupid that you created above
    PermissionGroupId = new Guid(&quot;974F50BF-A30A-4299-513C-08D7F0C40890&quot;),
    //The ui item permissionid that you created above and you want to group in given permission gorup
    UIItemPermissionId = new Guid(&quot;4AFB777B-56D7-4AB6-8D31-013E1EB6A66F&quot;),
    //Static but, randomly generated GUID, should not clash with other IDs
    Id = new Guid(&quot;4AFB777B-56D7-4AB6-8D31-013E1EB6A661&quot;)
},
</code></pre>
<ul>
<li><strong>Features (Your featureset members that packs all the permission groups in one place)</strong></li>
</ul>
<pre><code class="lang-csharp">new Feature() {
    //Static but, randomly generated GUID, should not clash with other permissions
    FeatureId = new Guid(&quot;94691F30-AA25-45E3-3A11-08D7F03075CC&quot;),
    //Your desired FeatureName that will be a member of your featureset
    FeatureName = &quot;Virtual Telemetry&quot;,
    //Description free-text
    Description = &quot;Virtual Telemetry&quot;,
    //Relationship between your created permission groups and this feature, add as many as permission groups here
    ApplicationFeaturePermissionGroups = new List&lt;ApplicationFeaturePermissionGroupRelation&gt;()
    {
        new ApplicationFeaturePermissionGroupRelation()
        {
            // The permissiongroupid that you created above
            PermissionGroupId = new Guid(&quot;974F50BF-A30A-4299-513C-08D7F0C40890&quot;),
            //Should be the same with your FeatureId that you defined above
            ApplicationFeatureId = new Guid(&quot;94691F30-AA25-45E3-3A11-08D7F03075CC&quot;),
            //Static but, randomly generated GUID, should not clash with other IDs
            Id = new Guid(&quot;EF50AD63-14A0-4176-A1FD-08D7F0EAC093&quot;)
        },
        new ApplicationFeaturePermissionGroupRelation()
        {
            // The permissiongroupid that you created else
            PermissionGroupId = new Guid(&quot;88AA50BF-A30A-4299-513C-08D7F0C40890&quot;),
            //Should be the same with your FeatureId that you defined above
            ApplicationFeatureId = new Guid(&quot;94691F30-AA25-45E3-3A11-08D7F03075CC&quot;),
            //Static but, randomly generated GUID, should not clash with other IDs
            Id = new Guid(&quot;CCC0AD63-14A0-4176-A1FD-08D7F0EAC093&quot;)
        },
    }
},

</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Carbon Framework
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
